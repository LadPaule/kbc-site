(()=>{"use strict";var t,e={88793:function(t,e,n){var o=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,i,l=n.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(o=l.next()).done;)r.push(o.value)}catch(t){i={error:t}}finally{try{o&&!o.done&&(n=l.return)&&n.call(l)}finally{if(i)throw i.error}}return r};e.__esModule=!0,e.TypedTableBlockValidationError=e.TypedTableBlockDefinition=e.TypedTableBlock=void 0;var l=n(75447),r=function(){function t(t,e,n,o,i){var r=this;this.blockDef=t,this.type=t.name,this.columns=[],this.rows=[],this.columnCountIncludingDeleted=0,this.rowCountIncludingDeleted=0,this.prefix=n,this.childBlockDefsByName={},this.blockDef.childBlockDefs.forEach((function(t){r.childBlockDefsByName[t.name]=t}));var a=this.blockDef.meta.strings,s=$('\n      <div class="typed-table-block '+l.escapeHtml(this.blockDef.meta.classname||"")+'">\n        <input type="hidden" name="'+l.escapeHtml(n)+'-column-count" data-column-count value="0">\n        <input type="hidden" name="'+l.escapeHtml(n)+'-row-count" data-row-count value="0">\n        <div data-deleted-fields></div>\n        <div class="typed-table-block__wrapper">\n          <table>\n            <thead>\n              <tr>\n                <th></th>\n                <th class="control-cell">\n                  <button type="button" class="button button-small button-secondary append-column" data-append-column>\n                    '+l.escapeHtml(a.ADD_COLUMN)+'\n                  </button>\n                </th>\n              </tr>\n            </thead>\n            <tbody>\n            </tbody>\n            <tfoot>\n              <tr>\n                <td class="control-cell">\n                  <button type="button"\n                    class="button button-small button-secondary button--icon text-replace prepend-row"\n                    aria-label="'+l.escapeHtml(a.ADD_ROW)+'" title="'+l.escapeHtml(a.ADD_ROW)+'" data-add-row>\n                    <svg class="icon icon-plus icon" aria-hidden="true" focusable="false">\n                      <use href="#icon-plus"></use>\n                    </svg>\n                  </button></td>\n              </tr>\n            </tfoot>\n          </table>\n        </div>\n      </div>\n    ');$(e).replaceWith(s),this.thead=s.find("table > thead").get(0),this.tbody=s.find("table > tbody").get(0),this.columnCountInput=s.find("input[data-column-count]").get(0),this.rowCountInput=s.find("input[data-row-count]").get(0),this.deletedFieldsContainer=s.find("[data-deleted-fields]").get(0),this.appendColumnButton=s.find("button[data-append-column]"),this.addRowButton=s.find("button[data-add-row]"),this.addRowButton.hide(),this.blockDef.meta.helpText&&s.append('\n        <span>\n          <div class="help">\n            '+this.blockDef.meta.helpIcon+"\n            "+this.blockDef.meta.helpText+"\n          </div>\n        </span>\n      "),this.addColumnCallback=null,this.addColumnMenu=$('<ul class="add-column-menu"></ul>'),this.blockDef.childBlockDefs.forEach((function(t){var e=$('<button type="button" class="button button-small"></button>').text(t.meta.label);e.on("click",(function(){r.addColumnCallback&&r.addColumnCallback(t),r.hideAddColumnMenu()}));var n=$("<li></li>").append(e);r.addColumnMenu.append(n)})),this.addColumnMenuBaseElement=null,this.appendColumnButton.on("click",(function(){r.toggleAddColumnMenu(r.appendColumnButton,(function(t){r.insertColumn(r.columns.length,t,{addInitialRow:!0})}))})),this.addRowButton.on("click",(function(){r.insertRow(r.rows.length)})),this.setState(o),i&&this.setError(i)}return t.prototype.showAddColumnMenu=function(t,e){this.addColumnMenuBaseElement=t,t.after(this.addColumnMenu),this.addColumnMenu.show(),this.addColumnCallback=e},t.prototype.hideAddColumnMenu=function(){this.addColumnMenu.hide(),this.addColumnMenuBaseElement=null},t.prototype.toggleAddColumnMenu=function(t,e){this.addColumnMenuBaseElement===t?this.hideAddColumnMenu():this.showAddColumnMenu(t,e)},t.prototype.clear=function(){this.columns=[],this.rows=[],this.columnCountIncludingDeleted=0,this.columnCountInput.value=0,this.rowCountIncludingDeleted=0,this.rowCountInput.value=0,this.deletedFieldsContainer.replaceChildren();var t=this.thead.children[0];t.replaceChildren(t.firstElementChild,t.lastElementChild),this.appendColumnButton.text(this.blockDef.meta.strings.ADD_COLUMN).removeClass("button--icon text-replace white").removeAttr("aria-label").removeAttr("title"),this.tbody.replaceChildren(),this.addRowButton.hide()},t.prototype.insertColumn=function(t,e,n){var o=this,i={blockDef:e,position:t,id:this.columnCountIncludingDeleted};this.columnCountIncludingDeleted++;for(var r=t;r<this.columns.length;r++)this.columns[r].position++,this.columns[r].positionInput.value=this.columns[r].position;this.columns.splice(t,0,i),this.columnCountInput.value=this.columnCountIncludingDeleted;var a=this.thead.children[0],s=a.children,u=document.createElement("th");a.insertBefore(u,s[t+1]),i.typeInput=document.createElement("input"),i.typeInput.type="hidden",i.typeInput.name=this.prefix+"-column-"+i.id+"-type",i.typeInput.value=e.name,u.appendChild(i.typeInput),i.positionInput=document.createElement("input"),i.positionInput.type="hidden",i.positionInput.name=this.prefix+"-column-"+i.id+"-order",i.positionInput.value=t,u.appendChild(i.positionInput),i.deletedInput=document.createElement("input"),i.deletedInput.type="hidden",i.deletedInput.name=this.prefix+"-column-"+i.id+"-deleted",i.deletedInput.value="",this.deletedFieldsContainer.appendChild(i.deletedInput);var d=$('<button type="button"\n      class="button button-secondary button-small button--icon text-replace prepend-column"\n      aria-label="'+l.escapeHtml(this.blockDef.meta.strings.INSERT_COLUMN)+'"\n      title="'+l.escapeHtml(this.blockDef.meta.strings.INSERT_COLUMN)+'">\n        <svg class="icon icon-plus icon" aria-hidden="true" focusable="false"><use href="#icon-plus"></use></svg>\n      </button>');$(u).append(d),d.on("click",(function(){o.toggleAddColumnMenu(d,(function(t){o.insertColumn(i.position,t,{addInitialRow:!0})}))})),i.headingInput=document.createElement("input"),i.headingInput.name=this.prefix+"-column-"+i.id+"-heading",i.headingInput.className="column-heading",i.headingInput.placeholder=this.blockDef.meta.strings.COLUMN_HEADING,u.appendChild(i.headingInput);var c=$('<button type="button"\n      class="button button-secondary button-small button--icon text-replace no delete-column"\n      aria-label="'+l.escapeHtml(this.blockDef.meta.strings.DELETE_COLUMN)+'"\n      title="'+l.escapeHtml(this.blockDef.meta.strings.DELETE_COLUMN)+'">\n        <svg class="icon icon-bin icon" aria-hidden="true" focusable="false"><use href="#icon-bin"></use></svg>\n      </button>');$(u).append(c),c.on("click",(function(){o.deleteColumn(i.position)}));var h=this.blockDef.childBlockDefaultStates[e.name];return Array.from(this.tbody.children).forEach((function(e,n){var l=o.rows[n],r=e.children,a=document.createElement("td");e.insertBefore(a,r[t+1]);var s=o.initCell(a,i,l,h);l.blocks.splice(t,0,s)})),this.addRowButton.show(),this.appendColumnButton.html('<svg class="icon icon-plus icon" aria-hidden="true" focusable="false"><use href="#icon-plus"></use></svg>').addClass("button--icon text-replace white").attr("aria-label",this.blockDef.meta.strings.ADD_COLUMN).attr("title",this.blockDef.meta.strings.ADD_COLUMN),n&&n.addInitialRow&&0===this.tbody.children.length&&this.insertRow(0),i},t.prototype.deleteColumn=function(t){var e=this;this.columns[t].deletedInput.value="1";var n=this.thead.children[0],o=n.children;n.removeChild(o[t+1]),Array.from(this.tbody.children).forEach((function(n,o){var i=n.children;n.removeChild(i[t+1]),e.rows[o].blocks.splice(t,1)})),this.columns.splice(t,1);for(var i=t;i<this.columns.length;i++)this.columns[i].position--,this.columns[i].positionInput.value=this.columns[i].position;0===this.columns.length&&this.clear()},t.prototype.insertRow=function(t,e){var n=this,o=document.createElement("tr"),i={blocks:[],position:t,id:this.rowCountIncludingDeleted};if(t<this.rows.length){var r=this.tbody.children[t];this.tbody.insertBefore(o,r)}else this.tbody.appendChild(o);this.rows.splice(t,0,i),this.rowCountIncludingDeleted++,this.rowCountInput.value=this.rowCountIncludingDeleted;var a=document.createElement("td");a.className="control-cell",o.appendChild(a);var s=$('<button type="button"\n      class="button button-secondary button-small button--icon text-replace prepend-row"\n      aria-label="'+l.escapeHtml(this.blockDef.meta.strings.INSERT_ROW)+'"\n      title="'+l.escapeHtml(this.blockDef.meta.strings.INSERT_ROW)+'">\n        <svg class="icon icon-plus icon" aria-hidden="true" focusable="false"><use href="#icon-plus"></use></svg>\n      </button>');$(a).append(s),s.on("click",(function(){n.insertRow(i.position)})),this.columns.forEach((function(t,l){var r;r=e?e[l]:n.blockDef.childBlockDefaultStates[t.blockDef.name];var a=document.createElement("td");o.appendChild(a),i.blocks[l]=n.initCell(a,t,i,r)}));var u=document.createElement("td");u.className="control-cell",o.appendChild(u),i.positionInput=document.createElement("input"),i.positionInput.type="hidden",i.positionInput.name=this.prefix+"-row-"+i.id+"-order",i.positionInput.value=i.position,u.appendChild(i.positionInput);var d=$('<button type="button"\n      class="button button-secondary button-small button--icon text-replace no delete-row"\n      aria-label="'+l.escapeHtml(this.blockDef.meta.strings.DELETE_ROW)+'"\n      title="'+l.escapeHtml(this.blockDef.meta.strings.DELETE_ROW)+'">\n        <svg class="icon icon-bin icon" aria-hidden="true" focusable="false"><use href="#icon-bin"></use></svg>\n      </button>');$(u).append(d),d.on("click",(function(){n.deleteRow(i.position)})),i.deletedInput=document.createElement("input"),i.deletedInput.type="hidden",i.deletedInput.name=this.prefix+"-row-"+i.id+"-deleted",i.deletedInput.value="",this.deletedFieldsContainer.appendChild(i.deletedInput);for(var c=t+1;c<this.rows.length;c++)this.rows[c].position++,this.rows[c].positionInput.value=this.rows[c].position;return i},t.prototype.deleteRow=function(t){this.rows[t].deletedInput.value="1";var e=this.tbody.children[t];this.tbody.removeChild(e),this.rows.splice(t,1);for(var n=t;n<this.rows.length;n++)this.rows[n].position--,this.rows[n].positionInput.value=this.rows[n].position},t.prototype.initCell=function(t,e,n,o){var i=document.createElement("div");t.appendChild(i);var l=this.prefix+"-cell-"+n.id+"-"+e.id;return e.blockDef.render(i,l,o,null)},t.prototype.setState=function(t){var e=this;this.clear(),t&&(t.columns.forEach((function(t,n){var o=e.childBlockDefsByName[t.type];e.insertColumn(n,o).headingInput.value=t.heading})),t.rows.forEach((function(t,n){e.insertRow(n,t.values)})))},t.prototype.setError=function(t){var e,n,l,r;if(1===t.length){var a=t[0];if(a.cellErrors)try{for(var s=o(Object.entries(a.cellErrors)),u=s.next();!u.done;u=s.next()){var d=i(u.value,2),c=d[0],h=d[1];try{for(var p=(l=void 0,o(Object.entries(h))),m=p.next();!m.done;m=p.next()){var f=i(m.value,2),b=f[0],v=f[1];this.rows[c].blocks[b].setError([v])}}catch(t){l={error:t}}finally{try{m&&!m.done&&(r=p.return)&&r.call(p)}finally{if(l)throw l.error}}}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}}},t.prototype.getState=function(){return{columns:this.columns.map((function(t){return{type:t.blockDef.name,heading:t.headingInput.value}})),rows:this.rows.map((function(t){return{values:t.blocks.map((function(t){return t.getState()}))}}))}},t.prototype.getValue=function(){return{columns:this.columns.map((function(t){return{type:t.blockDef.name,heading:t.headingInput.value}})),rows:this.rows.map((function(t){return{values:t.blocks.map((function(t){return t.getValue()}))}}))}},t.prototype.getTextLabel=function(t){var e,n,i,l,r=t&&t.maxLength,a="";try{for(var s=o(this.rows),u=s.next();!u.done;u=s.next()){var d=u.value;try{for(var c=(i=void 0,o(d.blocks)),h=c.next();!h.done;h=c.next()){var p=h.value;if(p.getTextLabel){var m=p.getTextLabel({maxLength:r});if(m)if(a){var f=a+", "+m;if(r&&f.length>r-1)return a.endsWith("…")||(a+="…"),a;a=f}else a=m}}}catch(t){i={error:t}}finally{try{h&&!h.done&&(l=c.return)&&l.call(c)}finally{if(i)throw i.error}}}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return a},t.prototype.focus=function(t){this.columns.length?this.rows.length?this.rows[0].blocks[0].focus(t):this.addRowButton.focus():this.appendColumnButton.focus()},t}();e.TypedTableBlock=r;var a=function(){function t(t,e,n,o){this.name=t,this.childBlockDefs=e,this.childBlockDefaultStates=n,this.meta=o}return t.prototype.render=function(t,e,n,o){return new r(this,t,e,n,o)},t}();e.TypedTableBlockDefinition=a,window.telepath.register("wagtail.contrib.typed_table_block.blocks.TypedTableBlock",a);var s=function(t){this.cellErrors=t};e.TypedTableBlockValidationError=s,window.telepath.register("wagtail.contrib.typed_table_block.TypedTableBlockValidationError",s)}},n={};function o(t){var i=n[t];if(void 0!==i)return i.exports;var l=n[t]={id:t,loaded:!1,exports:{}};return e[t].call(l.exports,l,l.exports,o),l.loaded=!0,l.exports}o.m=e,t=[],o.O=(e,n,i,l)=>{if(!n){var r=1/0;for(u=0;u<t.length;u++){for(var[n,i,l]=t[u],a=!0,s=0;s<n.length;s++)(!1&l||r>=l)&&Object.keys(o.O).every((t=>o.O[t](n[s])))?n.splice(s--,1):(a=!1,l<r&&(r=l));a&&(t.splice(u--,1),e=i())}return e}l=l||0;for(var u=t.length;u>0&&t[u-1][2]>l;u--)t[u]=t[u-1];t[u]=[n,i,l]},o.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.j=10,(()=>{var t={10:0};o.O.j=e=>0===t[e];var e=(e,n)=>{var i,l,[r,a,s]=n,u=0;for(i in a)o.o(a,i)&&(o.m[i]=a[i]);if(s)var d=s(o);for(e&&e(n);u<r.length;u++)l=r[u],o.o(t,l)&&t[l]&&t[l][0](),t[r[u]]=0;return o.O(d)},n=globalThis.webpackChunkwagtail=globalThis.webpackChunkwagtail||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})(),o.O(void 0,[751],(()=>o(88793)));var i=o.O(void 0,[751],(()=>o(90971)));i=o.O(i)})();
//# sourceMappingURL=typed_table_block.js.map